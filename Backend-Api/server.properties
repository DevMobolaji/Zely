process.roles=broker,controller
node.id=1
controller.listener.names=CONTROLLER

# Where Kafka binds
listeners=PLAINTEXT://0.0.0.0:9092,CONTROLLER://0.0.0.0:9093,EXTERNAL://0.0.0.0:9094

# What Kafka tells clients to use
# - EXTERNAL is for host machine (Node app)
advertised.listeners=PLAINTEXT://localhost:9092,EXTERNAL://host.docker.internal:9094,CONTROLLER://kafka:9093

listener.security.protocol.map=PLAINTEXT:PLAINTEXT,EXTERNAL:PLAINTEXT,CONTROLLER:PLAINTEXT

controller.quorum.voters=1@kafka:9093
auto.create.topics.enable=true
allow_plaintext_listeners=yes
log.dirs=/tmp/kraft-combined-logs

# --- REQUIRED FIXES FOR SINGLE-NODE GROUP COORDINATION ---

# FIX: Correct syntax for single-node Group Coordinator availability
offsets.topic.replication.factor=1 

# Explicitly bind coordinator to the EXTERNAL listener
group.coordinator.listeners=EXTERNAL://0.0.0.0:9094
group.initial.rebalance.delay.ms=3000

# Fixes for transactional producers (for single-node setup)
transaction.state.log.replication.factor=1
transaction.state.log.min.isr=1